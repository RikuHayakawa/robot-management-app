# --- Scalar ---

scalar DateTime

# --- Types ---

type Robot {
  id: ID!
  name: String!
  isActive: Boolean!
  createdAt: DateTime!
  updatedAt: DateTime!
  waypointLogs(limit: Int, after: String): WaypointLogConnection!
}

type WaypointLog {
  id: ID!
  robotId: ID!
  nodeId: ID!
  battery: Int!
  timestamp: DateTime!
  node: Node!
  robot: Robot!
}

type Position {
  x: Float!
  y: Float!
}

type Node {
  id: ID!
  name: String!
  position: Position!
}

# --- Cursor Connection (Relay-style) ---

type PageInfo {
  hasNextPage: Boolean!
  endCursor: String
}

type NodeEdge {
  node: Node!
  cursor: String!
}

type NodeConnection {
  edges: [NodeEdge!]!
  pageInfo: PageInfo!
}

type RobotEdge {
  node: Robot!
  cursor: String!
}

type RobotConnection {
  edges: [RobotEdge!]!
  pageInfo: PageInfo!
}

type WaypointLogEdge {
  node: WaypointLog!
  cursor: String!
}

type WaypointLogConnection {
  edges: [WaypointLogEdge!]!
  pageInfo: PageInfo!
}

# --- Queries (Read) ---

type Query {
  robots(limit: Int, after: String): RobotConnection!
  robot(id: ID!): Robot
  nodes(limit: Int, after: String): NodeConnection!
  node(id: ID!): Node
}

# --- Mutations (CRUD: Robotのみ) ---

input CreateRobotInput {
  name: String!
  isActive: Boolean!
}

input UpdateRobotInput {
  name: String
  isActive: Boolean
}

type Mutation {
  createRobot(input: CreateRobotInput!): Robot!
  updateRobot(id: ID!, input: UpdateRobotInput!): Robot!
  deleteRobot(id: ID!): Boolean!
}
